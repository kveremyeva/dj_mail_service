{% extends 'mailing/base.html' %}

{% block title %}
    {% if object %}Редактирование рассылки{% else %}Создание рассылки{% endif %}
{% endblock %}

{% block content %}

<a href="{% url 'mailing:mailing_list' %}" class="btn btn-secondary mb-3">← Назад к списку</a>

<h2>
    {% if object %}Редактирование рассылки{% else %}Создание новой рассылки{% endif %}
</h2>

<form method="post">
    {% csrf_token %}
    <div class="mb-3">
        <label for="{{ form.message.id_for_label }}" class="form-label">Сообщение:</label>
        {{ form.message }}
        {% if not form.message.field.queryset %}
            <div class="alert alert-warning mt-2">
                У вас нет созданных сообщений. <a href="{% url 'mailing:message_create' %}">Создайте сообщение</a> сначала.
            </div>
        {% endif %}
    </div>
    
    <div class="mb-3">
        <label for="{{ form.clients.id_for_label }}" class="form-label">Получатели:</label>
        {{ form.clients }}
        {% if not form.clients.field.queryset %}
            <div class="alert alert-warning mt-2">
                У вас нет созданных клиентов. <a href="{% url 'mailing:client_create' %}">Создайте клиентов</a> сначала.
            </div>
        {% else %}
            <div class="form-text">Выберите одного или нескольких клиентов (удерживайте Ctrl для множественного выбора)</div>
        {% endif %}
    </div>
    
    <button type="submit" class="btn btn-primary">
        {% if object %}Сохранить изменения{% else %}Создать рассылку{% endif %}
    </button>
    <a href="{% url 'mailing:mailing_list' %}" class="btn btn-secondary">Отмена</a>
</form>

{% endblock %}